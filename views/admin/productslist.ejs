
<%- include('../partials/admin/header') -%>
<body>
  <div class="screen-overlay"></div>
  <aside class="navbar-aside" id="offcanvas_aside">
      <div class="aside-top">
          <a href="index.html" class="brand-wrap">
              <img src="asset/imgs/theme/logo.png" class="logo" alt="GadgetsHub Dashboard">
          </a>
          <div>
              <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
          </div>
      </div>
      <nav>
          <ul class="menu-aside">
              <li class="menu-item">
                  <a class="menu-link" href="/admin"> <i class="icon material-icons md-home"></i>
                    <span class="text">Dashboard</span>
                  </a>
              </li>
              <li class="menu-item active has-submenu">
                  <a class="menu-link" href="page-products-list.html"> <i class="icon material-icons md-shopping_bag"></i>
                      <span class="text">Products</span>
                  </a>
                  <div class="submenu">
                      <a href="/admin/productList" class="active">Product List</a>
                      <a href="/admin/categoryPage">Categories</a>
                  </div>
              </li>
              <li class="menu-item has-submenu">
                  <a class="menu-link" href="#"> <i class="icon material-icons md-shopping_cart"></i>
                      <span class="text">Orders</span>
                  </a>
                  <div class="submenu">
                      <a href="/admin/order">Order List</a>                        
                  </div>
              </li>
              <li class="menu-item">
                  <a class="menu-link" href="/admin/addProduct"> <i class="icon material-icons md-add_box"></i>
                      <span class="text">Add product</span>
                  </a>                  
              </li>
              <li class="menu-item has-submenu">
                <a class="menu-link" href="#"> <i class="icon material-icons md-local_offer"></i>
                    <span class="text">Coupons</span>
                </a>
                <div class="submenu">
                    <a href="/admin/couponList">Coupon List</a>
                    <a href="/admin/addCoupon">Add Coupon</a>
                </div>
              </li>
              <li class="menu-item">
                  <a class="menu-link" href="/admin/userList"> <i class="icon material-icons md-group"></i>
                      <span class="text">Users</span>
                  </a>
              </li>
              <li class="menu-item has-submenu">
                <a class="menu-link" href="page-products-list.html"> <i class="icon material-icons md-shopping_bag"></i>
                    <span class="text">Offers</span>
                </a>
                <div class="submenu">
                    <a href="/admin/productOffer">Product Offer</a>
                    <!-- <a href="/admin/categoryOffer">Category Offer</a> -->
                </div>
              </li>
          </ul>
      </nav>
  </aside>
  <main class="main-wrap">
    <header class="main-header navbar">
      <div class="col-search">
      </div>
      <div class="col-nav">
          <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
          <ul class="nav">
              <li class="dropdown nav-item">
                  <a class="dropdown-item text-danger" href="/admin/logout"><i class="material-icons md-exit_to_app"></i>Logout</a>
              </li>
          </ul>
      </div>
  </header>


<section class="content-main">
  <div class="content-header">
    <div>
      <h2 class="content-title card-title">Products List</h2>
      <p></p>
    </div>
    <div>
      <a href="/admin/addProduct" class="btn btn-primary btn-sm rounded"
        >Create new</a
      >
    </div>
  </div>
  <div class="card mb-4">
    <header class="card-header">
      <div class="row align-items-center">
        <div class="col-lg-1 col-md-2 col-4 col-name">
          <span>#ID</span>
        </div>
        <div class="col-lg-3 col-md-5 col-8 col-name">
          <span>Product</span>
        </div>
        <div class="col-lg-1 col-md-2 col-4 col-price">
          <span>Price</span>
        </div>
        <div class="col-lg-1 col-md-2 col-4 col-price">
          <span>Quantity</span>
        </div>
        <div class="col-lg-2 col-md-2 col-4 col-status">
          <span>Category</span>
        </div>
        <div class="col-lg-1 col-md-1 col-4 col-date">
          <span>Brand</span>
        </div>
        <div class="col-lg-1 col-md-1 col-4 col-date">
          <span>Status</span>
        </div>
        <div class="col-lg-2 col-md-3 col-8 col-action">Action</div>
      </div>
      
    </header>
    <!-- card-header end//  -->
    <div class="card-body">
      <%products.reverse().forEach(function(product){%>
      <article class="itemlist">
        <div class="row align-items-center">
          <div class="col-lg-1 col-md-2 col-4 col-id">
            <div class="left">
              <%- product._id.toString().slice(-4) %>
            </div>
          </div>
          <div class="col-lg-3 col-md-5 col-8 col-name">
            <a class="itemside" href="#">
              <div class="left">
                <img
                  src="uploads/<%=product.productimages[0]%>"
                  class="img-sm img-thumbnail"
                  alt="Item"
                />
              </div>
              <div class="info">
                <h6 class="mb-0 description-truncate"><%=product.productname%></h6>
              </div>
            </a>
          </div>
          <div class="col-lg-1 col-md-2 col-4 col-price">
            <span>â‚¹<%=product.productprice%></span>
          </div>
          <div class="col-lg-1 col-md-2 col-4 col-price">
            <span><%=product.productquantity%></span>
          </div>
          <div class="col-lg-2 col-md-2 col-4 col-status">
            <span class="badge rounded-pill alert-success">
              <%=product.productcategory%>
            </span>
          </div>
          <div class="col-lg-1 col-md-1 col-4 col-date">
            <span><%=product.productbrand%></span>
          </div>
          <%if(product.isActive){%>
            <div class="col-lg-1 col-md-1 col-4 col-status">
              <span class="badge rounded-pill alert-success">Active</span>
            </div>
          <%} else {%>
            <div class="col-lg-1 col-md-1 col-4 col-status">
              <span class="badge rounded-pill alert-danger">Disabled</span>
            </div>
          <%}%>
          <div class="col-lg-2 col-md-3 col-8 col-action">
            <%if(product.isActive){%>            
              <a
                href="/admin/editProduct?id=<%=product._id%>"
                class="btn btn-sm font-sm rounded btn-brand">
                <i class="material-icons md-edit"></i> Edit
              </a>
              <a
                data-proid="<%=product._id%>"
                class="btn btn-sm font-sm btn-light rounded delete-button">
                <i class="material-icons md-delete_forever"></i> Delete
              </a>              
            <%} else {%>
              <a
                data-proid="<%=product._id%>"
                class="btn btn-sm font-sm rounded btn-brand activate-button">
                <i class="material-icons md-edit"></i> Activate
              </a>
            <%}%>
          </div>
        </div>
        <!-- row .// -->
      </article>
      <!-- itemlist  .// -->
      <%})%>
    </div>
    <!-- card-body end// -->
  </div>
  <!-- card end// -->
  <!-- <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">
                        <li class="page-item active"><a class="page-link" href="#">01</a></li>
                        <li class="page-item"><a class="page-link" href="#">02</a></li>
                        <li class="page-item"><a class="page-link" href="#">03</a></li>
                        <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                        <li class="page-item"><a class="page-link" href="#">16</a></li>
                        <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                    </ul>
                </nav>
            </div> -->
</section>
<!-- content-main end// -->

<%- include('../partials/admin/footer') -%>

<script>
  $(document).ready(function () {
    $(".delete-button").click(function () {
      let button = $(this);
      let proId = button.data("proid");
      let url = "/admin/deleteProduct?id=" + proId;
      Swal.fire({
        title: "Are you sure?",
        text: "This action cannot undone!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes",
      }).then((result) => {
        if (result.isConfirmed) {
          $.ajax({
            url: url,
            type: "GET",
            success: function (response) {
              Swal.fire({
                title: "Success",
                text: "Product Deleted",
                icon: "success",
                timer: 2000,
                showConfirmButton: false,
              }).then((result) => {
                location.reload();
              });
            },
            error: function (error) {
              console.log("Error: " + error);
            },
          });
        }
      });
    });
  });

  $(document).ready(function () {
    $(".activate-button").click(function () {
      let button = $(this);
      let proId = button.data("proid");
      let url = "/admin/activateProduct?id=" + proId;
      Swal.fire({
        title: "Are you sure?",
        text: "This action cannot undone!",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Yes",
      }).then((result) => {
        if (result.isConfirmed) {
          $.ajax({
            url: url,
            type: "GET",
            success: function (response) {
              Swal.fire({
                title: "Success",
                text: "Product Activated",
                icon: "success",
                timer: 2000,
                showConfirmButton: false,
              }).then((result) => {
                location.reload();
              });
            },
            error: function (error) {
              console.log("Error: " + error);
            },
          });
        }
      });
    });
  });
</script>
